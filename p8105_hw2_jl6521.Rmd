---
title: "p8105_hw2_jl6521"
author: "Jiayi"
date: "2024-09-25"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 1:

Description of the dataset: 

* The dataset contains the station's name, location (its latitude and longitude), routes served in each stations, whether there are vendings, entrance type, and ada. 
* Data cleaning: So far I convert the entry variable from character to logical variable; clean the column names of the dataset. The dimension of the dataset is 1868 observations with 19 columns. 

```{r problem1-1}
nyc_transit = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    entry = case_match(
      entry,
      "YES" ~ TRUE,
      "NO" ~ FALSE
    )) %>%
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry, vending, entrance_type, ada)
  
```

* There are 465 distinct stations. 
* There are 468 stations that are ADA compliant. 
* The proportion of station entrances / exits without vending allow entrance is `proportion`. 
```{r problem1-2}
nyc_transit[["line_name"]] = paste(nyc_transit[["station_name"]], nyc_transit[["line"]], sep = " ")
distinct_station = nrow(distinct(nyc_transit,line_name))
ada_compliant = nrow(filter(nyc_transit, ada == "TRUE"))
no_vending = nrow(filter(nyc_transit, vending == "NO"))
allow_entrance = nrow(filter(nyc_transit, entry == "TRUE"))
proportion = no_vending/allow_entrance
```

* There are `distinct_station` distinct stations serve the A train. 
* Of the stations that serve the A train, `ada_in_A` are ADA compliant.
```{r problem 1-3}
transit_new = 
  nyc_transit %>%
  janitor::clean_names() %>% 
  mutate(across(starts_with("route"),as.character)) %>% 
  pivot_longer(
    cols = starts_with("route"),
    names_to = "route_number", 
    values_to = "route_name"
  ) %>% 
  filter(route_name == "A") %>% 
  distinct(line_name,.keep_all = TRUE )
distinct_station = nrow(transit_new)
ada_in_A = nrow(filter(transit_new, ada == "TRUE"))
```

## Problem 2

```{problem 2 cleand data }
Mr_Trash_Wheel = read_excel("./data/202309 Trash Wheel Collection Data.xlsx",
                         sheet = "Mr. Trash Wheel",
                         range = "A2:N587",
                         na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(sports_balls = as.integer(sports_balls)) %>%
  mutate(which_trashwheel = "Mr. Trash Wheel") %>%
  mutate(year = as.character(year))

Professor_Trash_Wheel = read_excel("./data/202309 Trash Wheel Collection Data.xlsx",
                         sheet = "Professor Trash Wheel",
                         range = "A2:M109",
                         na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>%
  mutate(which_trashwheel = "Professor Trash Wheel") %>%
  mutate(year = as.character(year))

Gwynnda_Trash_Wheel = read_excel("./data/202309 Trash Wheel Collection Data.xlsx",
                         sheet = "Gwynnda Trash Wheel",
                         range = "A2:L159",
                         na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>%
  mutate(which_trashwheel = "Gwynnda Trash Wheel") %>%
  mutate(year = as.character(year))

combined_trash_dataset = bind_rows(Mr_Trash_Wheel,Professor_Trash_Wheel,Gwynnda_Trash_Wheel)
nrow_trash = nrow(combined_trash_dataset) 


total_weight = combined_trash_dataset %>% 
  filter(which_trashwheel == "Professor Trash Wheel") %>%
  pull(weight_tons) %>% 
  sum(na.rm = TRUE)

total_cigarette = combined_trash_dataset %>% 
  filter(which_trashwheel == "Gwynnda Trash Wheel" & month == "June" & year == 2022) %>%
  pull(cigarette_butts) %>% 
  sum(na.rm = TRUE)

```
Data description: in this combined dataset, there are `nrow_trash` observations. Key variables are weight and volume of the trash (weight_tons, volume_cubic_yards), different categories of trash (plastic_bottles, polystyrene, cigarette_butts, glass_bottles, plastic_bags, wrappers, sports_balls), and also the number of Maryland homes that are provided with electricity.

The total weight of trash collected by Professor Trash Wheel is `total_weight`. The total number of cigarette butts collected by Gwynnda in June of 2022 is `total_cigarette`. 



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
